<div class="advancement__level">
  <div class="item-controls flexrow">
    <a class="advancement__title class__add-level" data-type="add-class-level" title="{{localize "X-Levels"}}">
      <b>{{localize "X-Add-Level"}}</b>
      <i class="fas fa-plus"></i>
    </a>
    <!--a class="item-control item-display" title="{{localize "X-Display-Item"}}">
        <i class="fas fa-comments"></i>
      </a-->
    <a class="item-control class__delete-level text-align-middle" title="{{localize "X-Delete-Item"}}">
      <i class="fas fa-trash"></i>
    </a>
  </div>
  <section class="content flexrow">
    <div class="advancement__navigator">
      <nav class="item-advancement-tabs flexcol">
        <ul class="no-bullets">
          <li>
            <a data-tab="item-advancement-options-pools">
              {{localize "ED.AbilityPools"}}
            </a>
          </li>
          {{#each item.system.advancement.levels}}
            <li>
              <a data-tab="item-advancement-level-tab-{{this.level}}">
                {{localize "ED.CircleNumber" level=this.level}}
              </a>
            </li>
          {{/each}}
        </ul>
      </nav>
    </div>
    <div class="advancement__content item-advancement-body">
      <div class="tab advancement-options-pools flexcol" data-tab="item-advancement-options-pools">
        {{#each item.system.advancement.abilityOptions}}
        <!-- Ability Options -->
        <div class="{{@key}}-abilities">
          <h3>{{lookup @root.config.tier @key}}</h3>
          <div class="abilities-list abilities-pool {{@key}}-pool" data-drop-function="abilities-pool" data-pool-type="{{@key}}">
            {{#each this}}
              {{{ed-linkForUuid this}}}
            {{else}}
              {{localize
                "X-No abilities added yet. You can do it by just dragging and dropping them onto this field"}}
            {{/each}}
          </div>
        </div>
        {{/each}}
      </div>
      {{#each item.system.advancement.levels}}
        <div class="tab item-name advancement-level" name="system.advancement.level[{{this.level}}].id"
             data-tab="item-advancement-level-tab-{{this.level}}" value="{{@index}}" data-level-index="{{@index}}"
             data-level="{{this.level}}">

          <!-- Level Number -->
          <div class="title-level-number">
            {{!--<!--input class="" name="system.advancement.levels[{{this.level}}].level" type="number"
                   value="{{this.level}}" data-dtype="Number" /-->--}}
            {{!--numberInput this.level name=(concat "system.advancement.levels[" this.level "].level") step=1 min=1--}}
            {{localize "ED.Circle"}}&nbsp;{{this.level}}
          </div>

          <!-- Tier -->
          <p class="flexrow">
            <label>{{localize "X-Tier"}}</label>
            <span>
              <select class="" name="system.advancement.levels[{{@index}}].tier" type="text" value="{{this.tier}}"
                      data-dtype="String">
                <option value="">{{localize "ED.General.none"}}</option>
                {{selectOptions ../config.tier selected=this.tier sort=false}}
              </select>
            </span>
          </p>

          <!-- Resource Step -->
          <div class="resource-step">
            <p class="flexrow">
              <label>{{localize "X-Resource Step"}}</label>
              <span title="{{ed-diceFormulaForStep this.resourceStep}}">
                {{numberInput this.resourceStep name=(concat "system.advancement.levels[" this.level "].resourceStep") step=1
                              min=1}}
              </span>
            </p>
          </div>

          <!-- Class Talents -->
          <div class="class-abilities">
            <p class="flexrow">
              <label>{{localize "X-Talents"}}</label>
              <span class="abilities-list abilities-pool class-pool" data-drop-function="abilities-pool" data-pool-type="class">
                {{#each this.abilities.class}}
                  {{{ed-linkForUuid this}}}
                {{else}}
                  {{localize
                    "X-No abilities added yet. You can do it by just dragging and dropping them onto this field"}}
                {{/each}}
              </span>
            </p>
          </div>

          <!-- Free Abilities -->
          <div class="free-abilities">
            <p class="flexrow">
              <label>{{localize "X-Free Abilities"}}</label>
              <span class="abilities-list abilities-pool" data-drop-function="abilities-pool" data-pool-type="free">
                {{#each this.abilities.free}}
                  {{{ed-linkForUuid this}}}
                {{else}}
                  {{localize
                    "X-No abilities added yet. You can do it by just dragging and dropping them onto this field"}}
                {{/each}}
              </span>
            </p>
          </div>

          <!-- Special Abilities -->
          <div class="special-abilities">
            <p class="flexrow">
              <label>{{localize "X-Special Abilities"}}</label>
              <span class="abilities-list abilities-pool" data-drop-function="abilities-pool" data-pool-type="special">
                {{#each this.abilities.special}}
                  {{{ed-linkForUuid this}}}
                {{else}}
                  {{localize
                    "X-No abilities added yet. You can do it by just dragging and dropping them onto this field"}}
                {{/each}}
              </span>
            </p>
          </div>

          <!-- Effects -->
          <div class="class-effects">
            <p class="flexrow">
              <label>{{localize "X-Effects"}}</label>
              <span class="abilities-list effect-pool">
                {{#each this.effects}}
                  {{{ed-linkForUuid this}}}
                {{else}}
                  {{localize "X-No abilities added yet. You can do it by just dragging and dropping them onto this field"}}
                {{/each}}
              </span>
            </p>
          </div>
        </div>
      {{else}}
        {{localize "X-No levels added yet. Click the plus sign above to add some. Go ahead, just try. You can do it!"}}
      {{/each}}
    </div>
  </section>
</div>